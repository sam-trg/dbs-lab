CREATE TABLE ACTOR(

    Act_id NUMBER(3) PRIMARY KEY,
    Act_Name VARCHAR2(20),
    Act_Gender CHAR(1)

);


CREATE TABLE DIRECTOR(

    Dir_id NUMBER(3) PRIMARY KEY,
    Dir_Name VARCHAR2(20),
    Dir_Phone VARCHAR2(15)

); 


CREATE TABLE MOVIES(

    Mov_id NUMBER(3) PRIMARY KEY,
    Mov_Title VARCHAR2(20),
    Mov_Year NUMBER(4),
    Mov_Lang VARCHAR(15),
    Dir_id NUMBER(3) REFERENCES DIRECTOR(Dir_id)

); 


CREATE TABLE MOVIE_CAST(

    Act_id NUMBER(3) REFERENCES ACTOR(Act_id),
    Mov_id NUMBER(3) REFERENCES MOVIES(Mov_id),
    Role VARCHAR2(20)

);  


CREATE TABLE RATING(

    Mov_id NUMBER(3) REFERENCES MOVIES(Mov_id),
    Rev_Stars NUMBER(1)

); 


INSERT INTO DIRECTOR VALUES(1, 'Nolan', '9876543212');
INSERT INTO DIRECTOR VALUES(2, 'Rajamouli', '8876543212');
INSERT INTO DIRECTOR VALUES(3, 'Villeneuve', '7876543212');


INSERT INTO MOVIES VALUES(1, 'Batman', 2001, 'Eng', 1);
INSERT INTO MOVIES VALUES(2, 'Dune', 1984, 'Eng', 3);
INSERT INTO MOVIES VALUES(3, 'RRR', 2020, 'Tam', 2);
INSERT INTO MOVIES VALUES(4, 'Blade Runner', 2049, 'Eng', 3);
INSERT INTO MOVIES VALUES(5, 'Prestige', 2006, 'Eng', 1);


INSERT INTO ACTOR VALUES(1, 'Bale', 'M');
INSERT INTO ACTOR VALUES(2, 'Ledger', 'M');
INSERT INTO ACTOR VALUES(3, 'Murphy', 'M');
INSERT INTO ACTOR VALUES(4, 'Chalamet', 'M');
INSERT INTO ACTOR VALUES(5, 'Dhanush', 'M');
INSERT INTO ACTOR VALUES(6, 'Ford', 'M');
INSERT INTO ACTOR VALUES(7, 'Jackman', 'M');
INSERT INTO ACTOR VALUES(8, 'Freeman', 'M');


INSERT INTO MOVIE_CAST VALUES(1, 1, 'Bruce Wayne');
INSERT INTO MOVIE_CAST VALUES(1, 5, 'John');
INSERT INTO MOVIE_CAST VALUES(2, 1, 'Joker');
INSERT INTO MOVIE_CAST VALUES(2, 2, 'Feyd Rautha');
INSERT INTO MOVIE_CAST VALUES(4, 2, 'Paul');
INSERT INTO MOVIE_CAST VALUES(5, 3, 'Ramesh');
INSERT INTO MOVIE_CAST VALUES(6, 4, 'Agent');
INSERT INTO MOVIE_CAST VALUES(7, 5, 'Smith');
INSERT INTO MOVIE_CAST VALUES(8, 1, 'Alfred');


INSERT INTO RATING VALUES(1, 2);
INSERT INTO RATING VALUES(1, 3);
INSERT INTO RATING VALUES(1, 4);
INSERT INTO RATING VALUES(3, 3);
INSERT INTO RATING VALUES(3, 2);
INSERT INTO RATING VALUES(1, 4);
INSERT INTO RATING VALUES(1, 4);
INSERT INTO RATING VALUES(2, 2);
INSERT INTO RATING VALUES(4, 4);
INSERT INTO RATING VALUES(5, 4);
INSERT INTO RATING VALUES(2, 3);





 -- 1.
SELECT Mov_Title FROM MOVIES JOIN DIRECTOR ON MOVIES.Dir_id = DIRECTOR.DIR_ID where dir_name='Rajamouli';


 -- 2.
CREATE VIEW Director_Movies AS
(SELECT director.Dir_Name AS D, Count(movies.Mov_id) AS C FROM Director natural Join Movies GROUP BY Dir_Name);


create view actor_movies as
(select * from actor natural join movie_cast);
select * from actor_movies natural join movies;

-- 3.
SELECT Act_Name FROM Actor_MOVIES natural JOIN movies WHERE MOV_YEAR < 1995
    UNION
SELECT Act_Name FROM Actor_MOVIES natural JOIN movies WHERE MOV_YEAR > 2005;


 -- 4. 
SELECT MOVIES.MOV_TITLE, MAX(RATING.REV_STARS)
FROM RATING 
FULL JOIN MOVIES 
ON RATING.MOV_ID=MOVIES.MOV_ID 
GROUP BY MOVIES.MOV_TITLE
ORDER BY MOVIES.MOV_TITLE;


 -- 5.
UPDATE RATING SET REV_STARS=5 WHERE MOV_ID IN (SELECT MOV_ID FROM MOVIES natural JOIN DIRECTOR WHERE DIR_NAME='Rajamouli'); 
